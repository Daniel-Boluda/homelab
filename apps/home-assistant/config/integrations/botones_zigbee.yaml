automation:
  - alias: Botones Zigbee - acciones
    description: Automatización central para varios botones Zigbee
    mode: single
    trigger:
      # Botón encimera - single
      - platform: device
        domain: mqtt
        device_id: 9dda14043bae72c9cee67dee384a2faa
        type: action
        subtype: single
        id: boton_encimera_single

      # Botón mesilla Lucía - single
      - platform: device
        domain: mqtt
        device_id: a0bbf46c3e2b62d7e82e5a62cae70ef7
        type: action
        subtype: single
        id: boton_mesilla_lucia_single

      # Botón entrada - single
      - platform: device
        domain: mqtt
        device_id: 3e059844353a5d3504fe2f39e71d82a2
        type: action
        subtype: single
        id: boton_entrada_single

      # Botón entrada - double
      - platform: device
        domain: mqtt
        device_id: 3e059844353a5d3504fe2f39e71d82a2
        type: action
        subtype: double
        id: boton_entrada_double

    action:
      - choose:
          # Botón encimera → toggle luz
          - conditions:
              - condition: template
                value_template: "{{ trigger.id == 'boton_encimera_single' }}"
            sequence:
              - service: switch.toggle
                target:
                  entity_id: switch.luz_encimera

          # Botón mesilla Lucía → aviso
          - conditions:
              - condition: template
                value_template: "{{ trigger.id == 'boton_mesilla_lucia_single' }}"
              - condition: state
                entity_id: input_boolean.home_announcements_active
                state: "on"
            sequence:
              - service: notify.send_message
                data:
                  message: "Lucia necesita abrazos."
                target:
                  device_id:
                    - 54e59c960e82f66b7a554608a8e30f28

          # Botón entrada - single → encender pantalla
          - conditions:
              - condition: template
                value_template: "{{ trigger.id == 'boton_entrada_single' }}"
            sequence:
              - service: switch.turn_on
                target:
                  entity_id: switch.marco_entrada_pantalla

          # Botón entrada - double → apagar pantalla
          - conditions:
              - condition: template
                value_template: "{{ trigger.id == 'boton_entrada_double' }}"
            sequence:
              - service: switch.turn_off
                target:
                  entity_id: switch.marco_entrada_pantalla
