app-template:
  controller:
    # HA is not supported
    replicas: 1
    strategy: Recreate

  image:
    repository: minkwe/389ds
    tag: latest
  env:
    DIR_SUFFIX: dc=grigri,dc=cloud
    DIR_ADMIN_USERNAME: "admin"
    DIR_ADMIN_UID: "15000"
    DIR_USERS_HOME: "/home/"
  envFrom:
    - secretRef:
        name: ldap-secret
  service:
    main:
      type: LoadBalancer
      loadBalancerIP: 192.168.193.3
      externalTrafficPolicy: Local
      ports:
        http:
          enabled: false
        ldap:
          port: 389
          protocol: TCP
        ldaps:
          port: 636
          protocol: TCP

  ingress:
    main:
      enabled: false

  podSecurityContext:
    fsGroup: 99

  persistence:
    data:
      enabled: true
      mountPath: /var/lib/dirsrv
      accessMode: ReadWriteOnce
      size: 100Mi
      storageClass: longhorn-ssd
      skipuninstall: true
    config:
      enabled: true
      mountPath: /etc/dirsrv
      accessMode: ReadWriteOnce
      size: 100Mi
      storageClass: longhorn-ssd
      skipuninstall: true
    certs:
      enabled: true
      mountPath: /certs
      accessMode: ReadWriteOnce
      size: 10Mi
      storageClass: longhorn-ssd
      skipuninstall: true
    logs:
      enabled: true
      type: emptyDir
      mountPath: /var/log/dirsrv/slapd-dir/

  resources:
    requests:
      cpu: 10m
      memory: 128Mi
    limits:
      cpu: 200m
      memory: 256Mi

  nodeSelector:
    kubernetes.io/arch: amd64
